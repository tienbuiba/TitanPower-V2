!function(o){"use strict";o(function(){o(".awe-carousel").each(function(){o(this).carouselItem()}),o(".ts-item-member:not('.active-hover')").mouseenter(function(){o(this).addClass("hover")}).mouseleave(function(){o(this).removeClass("hover")})}),o.fn.carouselItem=function(){var e=this,i=o(e).data(),t={};i.responsive?(t.itemsDesktop=[1199,i.items],t.itemsDesktopSmall=[979,i.itemsDesktopSmall],t.itemsTablet=[768,i.itemsTablet],t.itemsMobile=[479,i.itemsMobile]):(t.items=i.items,1==t.items&&(t.transitionStyle=i.effect)),i.pagination&&(t.pagination=i.pagination),i.navigation&&(t.navigation=i.navigation,t.navigationText=["<i class='icon fontello icon-angle-left'></i>","<i class='icon fontello icon-angle-right'></i>"]),i.auto&&(t.autoPlay=1e3*i.timeAuto,t.stopOnHover=i.stopOnHover),0==i.mousedrag&&(t.mouseDrag=i.mousedrag),0==i.touchdrag&&(t.touchDrag=i.touchdrag),o(this).owlCarousel(t)},Drupal.behaviors.articles_masonry={attach:function(e,i){var t=o(".view-article-listing .view-content");if(t.length)if("undefined"!=typeof o().masonry){e!=document&&t.masonry("destroy");var a={transitionDuration:"0.2s",itemSelector:".article-card",percentPosition:!0};a={itemSelector:".article-card",gutter:0,percentPosition:!0,columnWidth:".grid-sizer"},t.masonry(a)}else console.log("Masonry is not loaded")}},Drupal.behaviors.excelpoint_search={attach:function(e,i){function t(){o(".desktop-search-wrapper .main-nav-search-form").data("shown",1);var e=250;o(".desktop-search-wrapper .main-nav-search-form .form-type-textfield").velocity({width:e,opacity:1},{duration:400,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0}),o(".region-main-menu .menu-block-wrapper.menu-name-main-menu.menu-level-1").velocity({opacity:.2},{duration:200,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0})}function a(){o(".desktop-search-wrapper .main-nav-search-form").data("shown",0),o(".desktop-search-wrapper .main-nav-search-form .form-type-textfield").velocity({width:"80px",opacity:0},{duration:400,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0}),o(".region-main-menu .menu-block-wrapper.menu-name-main-menu.menu-level-1").velocity({opacity:1},{duration:200,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:200,mobileHA:!0})}o(document).click(function(e){var i=o(".desktop-search-wrapper .main-nav-search-form");1==i.data("shown")&&(i.is(e.target)||0!==i.has(e.target).length||a())}),o(".main-nav-search-form .form-type-textfield input").click(function(o){o.stopPropagation()}),o(".desktop-search-wrapper .main-nav-search-form").click(function(e){if(o(this).data("shown")){var i=o("input.form-text",this).val();i?o(this).submit():(e.preventDefault(),a())}else e.preventDefault(),t()})}},Drupal.behaviors.excelpoint_search_mobile={attach:function(e,i){function t(){o(".mobile-search-wrapper .main-nav-search-form").data("shown",1),o(".mobile-search-wrapper").css("opacity",0).removeClass("hidden").show().velocity({opacity:1},{duration:200,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0}),o(".main-nav-search-form .form-type-textfield").velocity({width:"100%"},{duration:400,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0}),o(".navbar-brand, .mobile-country-switcher, #slogan").velocity({opacity:.2},{duration:200,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0})}function a(){o(".mobile-search-wrapper .main-nav-search-form").data("shown",0),o(".mobile-search-wrapper").velocity({opacity:0},{duration:200,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:function(){o(".mobile-search-wrapper").hide(),o(".main-nav-search-form .form-type-textfield").css("width","0%")},display:void 0,visibility:void 0,loop:!1,delay:!1,mobileHA:!0}),o(".navbar-brand, .mobile-country-switcher, #slogan").velocity({opacity:1},{duration:400,easing:"swing",queue:"",begin:void 0,progress:void 0,complete:void 0,display:void 0,visibility:void 0,loop:!1,delay:0,mobileHA:!0})}o("#main-wrapper, #footer, #footer2").click(function(e){if(!o(".mobile-search-trigger").is(e.currentTarget)){var i=o(".mobile-search-wrapper .main-nav-search-form");1==i.data("shown")&&(i.is(e.target)||0!==i.has(e.target).length||a())}}),o(".mobile-search-trigger").click(function(o){o.stopPropagation(),t()}),o(".mobile-search-wrapper .main-nav-search-form .form-submit").click(function(e){var i=o(".mobile-search-wrapper .main-nav-search-form input.form-text").val();i||(e.preventDefault(),a())})}},Drupal.behaviors.excelpoint_country={attach:function(e,i){var t='<ul class="dropdown-menu" data-container="body">         <li class="active"><a href="#">Singapore</a></li>         <li><a href="#">PRC/HK</a></li>       </ul>';t="test",o("#country-switcher").popover({content:t,html:!0,placement:"bottom"})}},Drupal.behaviors.ras_to_top={attach:function(e,i){o(".back-to-top").css("opacity",.3),o(window).scroll(function(e){o(window).scrollTop()>400?o(".back-to-top").css("opacity",1):o(".back-to-top").css("opacity",.3)})}},Drupal.behaviors.ras_letter_browsing={attach:function(e,i){var t=o(".letter-browsing-container");if(t.length>0){var a="abcdefghijklmnopqrstuvwxyz".split(""),n={};o("a.letter-browsing-anchor").each(function(e,i){var t=o(i).data("letter");t&&(n[t]=1)});for(var r=[],s=0;26>s;s++){var d=a[s],c="";"undefined"==typeof n[d]&&(c="unavailable"),r.push('<li class="'+c+'"><a href="#'+d+'" class="letter-browsing">'+d+"</a></li>")}r="<ul>"+r.join("")+"</ul>",o(t).each(function(e,i){o(i).empty().append(r)}),o("body").append('<div class="letter-browsing-container-floating hidden">'+r+"</div>"),o(window).scroll(function(e){var i=o(window).scrollTop();o(t).each(function(e,t){i>o(t).offset().top+30?o(".letter-browsing-container-floating").removeClass("hidden").show():o(".letter-browsing-container-floating").hide()})})}}}}(jQuery),function(o,e,i,t,a){e.behaviors.radix_dropdown={attach:function(e,a){o(".dropdown-special").once("radix-dropdown",function(){function e(){o(n).hasClass("open")||o('>[data-toggle="dropdown"]',n).trigger("click.bs.dropdown")}function a(){o(n).hasClass("open")&&o('>[data-toggle="dropdown"]',n).trigger("click.bs.dropdown")}var n=this;o(this).on("mouseenter.radix.dropdown",function(o){e()}),o(this).on("mouseleave.radix.dropdown",function(){a()}),o(this).on("focusin.radix.dropdown",function(){e()}),o("body").once("radix-dropdown").on("focusout.radix.dropdown",function(e){var i=o(e.target).closest("li.radix-dropdown-processed.open").get(0);i&&setTimeout(function(){t.activeElement&&t.activeElement!==t.body&&!i.contains(t.activeElement)&&o(i).hasClass("open")&&o(i).trigger("click.bs.dropdown")},0)}),o(this).on("keydown.radix.dropdown",function(e){return 38==e.keyCode||40==e.keyCode?!1:32==e.keyCode?(o('>[data-toggle="dropdown"]',n).trigger("click.bs.dropdown"),!1):27==e.keyCode?(o('>[data-toggle="dropdown"]',n).focus(),a(),!1):void 0}),o(this).has("> a.dropdown-toggle")&&o(this).on("click.radix.dropdown",function(e){var t=o(e.target);t.parent().get(0)==n&&t.is("a.dropdown-toggle")&&t.attr("href")&&(e.preventDefault(),i.location.href=t.attr("href"))})})}},e.behaviors.radix_tooltip={attach:function(e,i){o.fn.tooltip&&o("[data-toggle='tooltip']").tooltip()}},e.behaviors.radix_popover={attach:function(e,i){o.fn.popover&&o("[data-toggle='popover']").popover()}},o(t).ready(function(){if(o.fn.tab){var e=o(".nav-tabs").not(".primary");e.children("li").first().find("a").tab("show"),(hash=i.location.hash)&&o('.nav-tabs > li > a[href$="'+hash+'"]').tab("show")}})}(jQuery,Drupal,this,this.document),function(o,e,i,t,a){e.behaviors.radix_dropdown={attach:function(e,a){o(".dropdown-special").once("radix-dropdown",function(){function e(){o(n).hasClass("open")||o('>[data-toggle="dropdown"]',n).trigger("click.bs.dropdown")}function a(){o(n).hasClass("open")&&o('>[data-toggle="dropdown"]',n).trigger("click.bs.dropdown")}var n=this;o(this).on("mouseenter.radix.dropdown",function(o){e()}),o(this).on("mouseleave.radix.dropdown",function(){a()}),o(this).on("focusin.radix.dropdown",function(){e()}),o("body").once("radix-dropdown").on("focusout.radix.dropdown",function(e){var i=o(e.target).closest("li.radix-dropdown-processed.open").get(0);i&&setTimeout(function(){t.activeElement&&t.activeElement!==t.body&&!i.contains(t.activeElement)&&o(i).hasClass("open")&&o(i).trigger("click.bs.dropdown")},0)}),o(this).on("keydown.radix.dropdown",function(e){return 38==e.keyCode||40==e.keyCode?!1:32==e.keyCode?(o('>[data-toggle="dropdown"]',n).trigger("click.bs.dropdown"),!1):27==e.keyCode?(o('>[data-toggle="dropdown"]',n).focus(),a(),!1):void 0}),o(this).has("> a.dropdown-toggle")&&o(this).on("click.radix.dropdown",function(e){var t=o(e.target);t.parent().get(0)==n&&t.is("a.dropdown-toggle")&&t.attr("href")&&(e.preventDefault(),i.location.href=t.attr("href"))})})}},e.behaviors.radix_tooltip={attach:function(e,i){o.fn.tooltip&&o("[data-toggle='tooltip']").tooltip()}},e.behaviors.radix_popover={attach:function(e,i){o.fn.popover&&o("[data-toggle='popover']").popover()}},o(t).ready(function(){if(o.fn.tab){var e=o(".nav-tabs").not(".primary");e.children("li").first().find("a").tab("show"),(hash=i.location.hash)&&o('.nav-tabs > li > a[href$="'+hash+'"]').tab("show")}})}(jQuery,Drupal,this,this.document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4Y2VscG9pbnRfcmFkaXguc2NyaXB0LmpzIiwicmFkaXgtc2NyaXB0LmJrLmpzIiwicmFkaXguc2NyaXB0LmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwidGhpcyIsImNhcm91c2VsSXRlbSIsIm1vdXNlZW50ZXIiLCJhZGRDbGFzcyIsIm1vdXNlbGVhdmUiLCJyZW1vdmVDbGFzcyIsImZuIiwic2VsZiIsImRhdGEiLCJzZXR0aW5ncyIsInJlc3BvbnNpdmUiLCJpdGVtc0Rlc2t0b3AiLCJpdGVtcyIsIml0ZW1zRGVza3RvcFNtYWxsIiwiaXRlbXNUYWJsZXQiLCJpdGVtc01vYmlsZSIsInRyYW5zaXRpb25TdHlsZSIsImVmZmVjdCIsInBhZ2luYXRpb24iLCJuYXZpZ2F0aW9uIiwibmF2aWdhdGlvblRleHQiLCJhdXRvIiwiYXV0b1BsYXkiLCJ0aW1lQXV0byIsInN0b3BPbkhvdmVyIiwibW91c2VkcmFnIiwibW91c2VEcmFnIiwidG91Y2hkcmFnIiwidG91Y2hEcmFnIiwib3dsQ2Fyb3VzZWwiLCJEcnVwYWwiLCJiZWhhdmlvcnMiLCJhcnRpY2xlc19tYXNvbnJ5IiwiYXR0YWNoIiwiY29udGV4dCIsIiRjb250YWluZXIiLCJsZW5ndGgiLCJtYXNvbnJ5IiwiZG9jdW1lbnQiLCJtYXNvbnJ5T3B0aW9ucyIsInRyYW5zaXRpb25EdXJhdGlvbiIsIml0ZW1TZWxlY3RvciIsInBlcmNlbnRQb3NpdGlvbiIsImd1dHRlciIsImNvbHVtbldpZHRoIiwiY29uc29sZSIsImxvZyIsImV4Y2VscG9pbnRfc2VhcmNoIiwic2hvd1NlYXJjaCIsInNlYXJjaF93ZGl0aCIsInZlbG9jaXR5Iiwid2lkdGgiLCJvcGFjaXR5IiwiZHVyYXRpb24iLCJlYXNpbmciLCJxdWV1ZSIsImJlZ2luIiwidW5kZWZpbmVkIiwicHJvZ3Jlc3MiLCJjb21wbGV0ZSIsImRpc3BsYXkiLCJ2aXNpYmlsaXR5IiwibG9vcCIsImRlbGF5IiwibW9iaWxlSEEiLCJoaWRlU2VhcmNoIiwiY2xpY2siLCJlIiwiY29udGFpbmVyIiwiaXMiLCJ0YXJnZXQiLCJoYXMiLCJzdG9wUHJvcGFnYXRpb24iLCJzZWFyY2hUZXJtIiwidmFsIiwic3VibWl0IiwicHJldmVudERlZmF1bHQiLCJleGNlbHBvaW50X3NlYXJjaF9tb2JpbGUiLCJzaG93TW9iaWxlU2VhcmNoIiwiY3NzIiwic2hvdyIsImhpZGVNb2JpbGVTZWFyY2giLCJoaWRlIiwiY3VycmVudFRhcmdldCIsImV4Y2VscG9pbnRfY291bnRyeSIsImNvbnRlbnQiLCJwb3BvdmVyIiwiaHRtbCIsInBsYWNlbWVudCIsInJhc190b190b3AiLCJ3aW5kb3ciLCJzY3JvbGwiLCJldmVudCIsInNjcm9sbFRvcCIsInJhc19sZXR0ZXJfYnJvd3NpbmciLCJjb250YWluZXJzIiwibGV0dGVycyIsInNwbGl0IiwiYXZhaWxhYmxlX2xldHRlcnMiLCJpbmRleCIsImFuY2hvciIsImxldHRlciIsImxpbmtzIiwiaSIsImNsYXNzTmFtZSIsInB1c2giLCJqb2luIiwiZW1wdHkiLCJhcHBlbmQiLCJzY3JvbGxZIiwib2Zmc2V0IiwidG9wIiwialF1ZXJ5IiwicmFkaXhfZHJvcGRvd24iLCJzZXR0aW5nIiwib25jZSIsImRyb3Bkb3duIiwiaGFzQ2xhc3MiLCJ0cmlnZ2VyIiwib24iLCJwYXJlbnQiLCJjbG9zZXN0IiwiZ2V0Iiwic2V0VGltZW91dCIsImFjdGl2ZUVsZW1lbnQiLCJib2R5IiwiY29udGFpbnMiLCJrZXlDb2RlIiwiZm9jdXMiLCIkdGFyZ2V0IiwiYXR0ciIsImxvY2F0aW9uIiwiaHJlZiIsInJhZGl4X3Rvb2x0aXAiLCJ0b29sdGlwIiwicmFkaXhfcG9wb3ZlciIsInJlYWR5IiwidGFiIiwidGFicyIsIm5vdCIsImNoaWxkcmVuIiwiZmlyc3QiLCJmaW5kIiwiaGFzaCJdLCJtYXBwaW5ncyI6IkNBS0EsU0FBQUEsR0FDQSxZQUNBQSxHQUFBLFdBQ0FBLEVBQUEsaUJBQUFDLEtBQUEsV0FDQUQsRUFBQUUsTUFBQUMsaUJBR0FILEVBQUEsd0NBQUFJ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QUFBLGFBQUE2SSxJQUFBLFdBQ0FELEdBQUFFLFNBQUEsTUFBQUMsUUFBQUMsS0FBQSxLQUFBTCxJQUFBLFNBRUFNLEtBQUFyRCxFQUFBeUMsU0FBQVksT0FDQWpKLEVBQUEsNkJBQUFpSixLQUFBLE1BQUFOLElBQUEsWUFJQXpCLE9BQUFsRixPQUFBOUIsS0FBQUEsS0FBQXNDIiwiZmlsZSI6ImV4Y2VscG9pbnRfcmFkaXguc2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZVxuICogU2NyaXB0cyBmb3IgZXhjZWxwb2ludCB0aGVtZS5cbiAqL1xuXG4oZnVuY3Rpb24gKCQpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gICQoZnVuY3Rpb24gKCkge1xuICAgICQoJy5hd2UtY2Fyb3VzZWwnKS5lYWNoKCBmdW5jdGlvbiAoKSB7XG4gICAgICAkKHRoaXMpLmNhcm91c2VsSXRlbSgpO1xuICAgIH0pO1xuXG4gICAgJChcIi50cy1pdGVtLW1lbWJlcjpub3QoJy5hY3RpdmUtaG92ZXInKVwiKS5tb3VzZWVudGVyKGZ1bmN0aW9uKCl7XG4gICAgICAkKHRoaXMpLmFkZENsYXNzKFwiaG92ZXJcIik7XG4gICAgfSkubW91c2VsZWF2ZShmdW5jdGlvbigpe1xuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiaG92ZXJcIik7XG4gICAgICB9KTtcblxuXG4gIH0pO1xuXG4gICQuZm4uY2Fyb3VzZWxJdGVtID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgIGRhdGEgPSAkKHNlbGYpLmRhdGEoKSxcbiAgICAgIHNldHRpbmdzID0ge307XG4gICAgaWYgKCFkYXRhLnJlc3BvbnNpdmUpIHtcbiAgICAgIHNldHRpbmdzLml0ZW1zID0gZGF0YS5pdGVtcztcbiAgICAgIGlmIChzZXR0aW5ncy5pdGVtcyA9PSAxKSB7XG4gICAgICAgIHNldHRpbmdzLnRyYW5zaXRpb25TdHlsZSA9IGRhdGEuZWZmZWN0O1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHNldHRpbmdzLml0ZW1zRGVza3RvcCA9IFsxMTk5LCBkYXRhLml0ZW1zXTtcbiAgICAgIHNldHRpbmdzLml0ZW1zRGVza3RvcFNtYWxsID0gWzk3OSwgZGF0YS5pdGVtc0Rlc2t0b3BTbWFsbF07XG4gICAgICBzZXR0aW5ncy5pdGVtc1RhYmxldCA9IFs3NjgsIGRhdGEuaXRlbXNUYWJsZXRdO1xuICAgICAgc2V0dGluZ3MuaXRlbXNNb2JpbGUgPSBbNDc5LCBkYXRhLml0ZW1zTW9iaWxlXTtcbiAgICB9XG4gICAgaWYgKGRhdGEucGFnaW5hdGlvbikge1xuICAgICAgc2V0dGluZ3MucGFnaW5hdGlvbiA9IGRhdGEucGFnaW5hdGlvblxuICAgIH1cbiAgICBpZiAoZGF0YS5uYXZpZ2F0aW9uKSB7XG4gICAgICBzZXR0aW5ncy5uYXZpZ2F0aW9uID0gZGF0YS5uYXZpZ2F0aW9uO1xuICAgICAgc2V0dGluZ3MubmF2aWdhdGlvblRleHQgPSBbXCI8aSBjbGFzcz0naWNvbiBmb250ZWxsbyBpY29uLWFuZ2xlLWxlZnQnPjwvaT5cIixcIjxpIGNsYXNzPSdpY29uIGZvbnRlbGxvIGljb24tYW5nbGUtcmlnaHQnPjwvaT5cIl07XG4gICAgfVxuICAgIGlmIChkYXRhLmF1dG8pIHtcbiAgICAgIHNldHRpbmdzLmF1dG9QbGF5ID0gZGF0YS50aW1lQXV0byAqIDEwMDA7XG4gICAgICBzZXR0aW5ncy5zdG9wT25Ib3ZlciA9IGRhdGEuc3RvcE9uSG92ZXI7XG4gICAgfVxuICAgIGlmIChkYXRhLm1vdXNlZHJhZyA9PSBmYWxzZSkge1xuICAgICAgc2V0dGluZ3MubW91c2VEcmFnID0gZGF0YS5tb3VzZWRyYWdcbiAgICB9XG4gICAgaWYgKGRhdGEudG91Y2hkcmFnID09IGZhbHNlKSB7XG4gICAgICBzZXR0aW5ncy50b3VjaERyYWcgPSBkYXRhLnRvdWNoZHJhZztcbiAgICB9XG4gICAgJCh0aGlzKS5vd2xDYXJvdXNlbChzZXR0aW5ncyk7XG4gIH07XG5cbiAgRHJ1cGFsLmJlaGF2aW9ycy5hcnRpY2xlc19tYXNvbnJ5ID0ge1xuICAgIGF0dGFjaDogZnVuY3Rpb24gKGNvbnRleHQsIHNldHRpbmdzKSB7XG5cbiAgICAgIHZhciAkY29udGFpbmVyID0gJCgnLnZpZXctYXJ0aWNsZS1saXN0aW5nIC52aWV3LWNvbnRlbnQnKTtcbiAgICAgIGlmICgkY29udGFpbmVyLmxlbmd0aCkge1xuXG4gICAgICAgIC8vIENoZWNrIGlmIG1hc29ucnkgaXMgbG9hZGVkXG4gICAgICAgIGlmICh0eXBlb2YgJCgpLm1hc29ucnkgIT0gJ3VuZGVmaW5lZCcpIHtcblxuICAgICAgICAgIGlmIChjb250ZXh0ICE9IGRvY3VtZW50KSB7XG4gICAgICAgICAgICAvLyBUaGlzIGlzIG5vdCB0aGUgZmlyc3QgbG9hZCwgaS5lLiB0aGlzIGlzIGFuIGFqYXggdHJpZ2dlcmVkIGF0dGFjaC5cblxuICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgbWFzb25yeSBzbyBhcyB0byByZWluaXRpYWxpemUuXG4gICAgICAgICAgICAkY29udGFpbmVyLm1hc29ucnkoJ2Rlc3Ryb3knKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL3ZhciBtYXNvbnJ5T3B0aW9uc09sZCA9IHtcbiAgICAgICAgICAvLyAgaXRlbVNlbGVjdG9yOiAnLmFydGljbGUtY2FyZCcsXG4gICAgICAgICAgLy8gIGNvbHVtbldpZHRoOiAzMTAsXG4gICAgICAgICAgLy8gIGd1dHRlcldpZHRoOiA4LFxuICAgICAgICAgIC8vICBpc0FuaW1hdGVkOiB0cnVlLFxuICAgICAgICAgIC8vICBhbmltYXRpb25PcHRpb25zOiB7XG4gICAgICAgICAgLy8gICAgZHVyYXRpb246IDYwMCxcbiAgICAgICAgICAvLyAgICBlYXNpbmc6ICdsaW5lYXInLFxuICAgICAgICAgIC8vICAgIHF1ZXVlOiBmYWxzZVxuICAgICAgICAgIC8vICB9XG4gICAgICAgICAgLy99O1xuXG4gICAgICAgICAgdmFyIG1hc29ucnlPcHRpb25zID0ge1xuICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiAnMC4ycycsXG4gICAgICAgICAgICBpdGVtU2VsZWN0b3I6ICcuYXJ0aWNsZS1jYXJkJyxcbiAgICAgICAgICAgIHBlcmNlbnRQb3NpdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIC8vY29sdW1uV2lkdGg6ICcuZ3JpZC1zaXplcicsXG4gICAgICAgICAgICAvL2d1dHRlcjogJy5ndXR0ZXItc2l6ZXInLFxuICAgICAgICAgICAgLy91c2VJbWFnZXNMb2FkZWQ6IHRydWUsXG4gICAgICAgICAgICAvL2lzQW5pbWF0ZWQ6IHRydWUsXG4gICAgICAgICAgICAvL2FuaW1hdGlvbk9wdGlvbnM6IHtcbiAgICAgICAgICAgIC8vICBkdXJhdGlvbjogNjAwLFxuICAgICAgICAgICAgLy8gIGVhc2luZzogJ2xpbmVhcicsXG4gICAgICAgICAgICAvLyAgcXVldWU6IGZhbHNlXG4gICAgICAgICAgICAvL31cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8kY29udGFpbmVyLm1hc29ucnkub24oJ2xheW91dENvbXBsZXRlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAvL30pO1xuICAgICAgICAgIC8vJGNvbnRhaW5lci5tYXNvbnJ5LmxheW91dCgpO1xuXG4gICAgICAgICAgbWFzb25yeU9wdGlvbnMgPSB7XG4gICAgICAgICAgICBpdGVtU2VsZWN0b3I6ICcuYXJ0aWNsZS1jYXJkJyxcbiAgICAgICAgICAgIGd1dHRlcjogMCxcbiAgICAgICAgICAgIHBlcmNlbnRQb3NpdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIGNvbHVtbldpZHRoOiAnLmdyaWQtc2l6ZXInXG4gICAgICAgICAgfTtcblxuICAgICAgICAgICRjb250YWluZXIubWFzb25yeShtYXNvbnJ5T3B0aW9ucyk7XG5cbiAgICAgICAgICAvLyRjb250YWluZXIuYmluZCgnY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vICAkY29udGFpbmVyLm1hc29ucnkoJ3JlbG9hZCcpO1xuICAgICAgICAgIC8vfSk7XG5cbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgY29uc29sZS5sb2coJ01hc29ucnkgaXMgbm90IGxvYWRlZCcpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG4gIH07XG5cblxuICBEcnVwYWwuYmVoYXZpb3JzLmV4Y2VscG9pbnRfc2VhcmNoID0ge1xuICAgIGF0dGFjaDogZnVuY3Rpb24gKGNvbnRleHQsIHNldHRpbmdzKSB7XG5cbiAgICAgIC8vJCgnLm1haW4tbmF2LXNlYXJjaC1mb3JtIC5mb3JtLXR5cGUtdGV4dGZpZWxkIGlucHV0Jykub24oJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAvLyAgaWYgKGV2ZW50LmtleUNvZGUgPT0gMTMpIHtcbiAgICAgIC8vICAgIC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIC8vICAgICQodGhpcykuY2xvc2VzdCgnZm9ybScpLnN1Ym1pdCgpO1xuICAgICAgLy8gIH1cbiAgICAgIC8vfSk7XG5cbiAgICAgIC8vIEhpZGUgc2VhcmNoIHdoZW4gZWxzZSB3aGVyZSBpcyBjbGlja2VkLlxuICAgICAgJChkb2N1bWVudCkuY2xpY2soZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9ICQoXCIuZGVza3RvcC1zZWFyY2gtd3JhcHBlciAubWFpbi1uYXYtc2VhcmNoLWZvcm1cIik7XG4gICAgICAgIGlmIChjb250YWluZXIuZGF0YSgnc2hvd24nKSA9PSAxKSB7XG4gICAgICAgICAgaWYgKCFjb250YWluZXIuaXMoZS50YXJnZXQpIC8vIGlmIHRoZSB0YXJnZXQgb2YgdGhlIGNsaWNrIGlzbid0IHRoZSBjb250YWluZXIuLi5cbiAgICAgICAgICAgICYmIGNvbnRhaW5lci5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMCkgLy8gLi4uIG5vciBhIGRlc2NlbmRhbnQgb2YgdGhlIGNvbnRhaW5lclxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGhpZGVTZWFyY2goKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAkKCcubWFpbi1uYXYtc2VhcmNoLWZvcm0gLmZvcm0tdHlwZS10ZXh0ZmllbGQgaW5wdXQnKS5jbGljayhmdW5jdGlvbiAoZSkge1xuICAgICAgICAvLyBTbyB0aGF0IGNsaWNraW5nIG9uIHRoZSBzZWFyY2ggdGV4dGZpZWxkIHdpbGwgbm90IGNvbGxhcHNlIHNlYXJjaC5cbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH0pO1xuXG4gICAgICAkKCcuZGVza3RvcC1zZWFyY2gtd3JhcHBlciAubWFpbi1uYXYtc2VhcmNoLWZvcm0nKS5jbGljayhmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ3Nob3duJykpIHtcbiAgICAgICAgICB2YXIgc2VhcmNoVGVybSA9ICQoJ2lucHV0LmZvcm0tdGV4dCcsIHRoaXMpLnZhbCgpO1xuICAgICAgICAgIGlmIChzZWFyY2hUZXJtKSB7XG4gICAgICAgICAgICAkKHRoaXMpLnN1Ym1pdCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBoaWRlU2VhcmNoKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBzaG93U2VhcmNoKCk7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIHNob3dTZWFyY2goKXtcbiAgICAgICAgJCgnLmRlc2t0b3Atc2VhcmNoLXdyYXBwZXIgLm1haW4tbmF2LXNlYXJjaC1mb3JtJykuZGF0YSgnc2hvd24nLCAxKTtcblxuICAgICAgICB2YXIgc2VhcmNoX3dkaXRoID0gMjUwO1xuXG4gICAgICAgICQoJy5kZXNrdG9wLXNlYXJjaC13cmFwcGVyIC5tYWluLW5hdi1zZWFyY2gtZm9ybSAuZm9ybS10eXBlLXRleHRmaWVsZCcpLnZlbG9jaXR5KHtcbiAgICAgICAgICB3aWR0aDogc2VhcmNoX3dkaXRoLFxuICAgICAgICAgIG9wYWNpdHk6IDEuMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgZHVyYXRpb246IDQwMCxcbiAgICAgICAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICAgICAgICBxdWV1ZTogXCJcIixcbiAgICAgICAgICBiZWdpbjogdW5kZWZpbmVkLFxuICAgICAgICAgIHByb2dyZXNzOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29tcGxldGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBkaXNwbGF5OiB1bmRlZmluZWQsXG4gICAgICAgICAgdmlzaWJpbGl0eTogdW5kZWZpbmVkLFxuICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgIGRlbGF5OiBmYWxzZSxcbiAgICAgICAgICBtb2JpbGVIQTogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICAkKCcucmVnaW9uLW1haW4tbWVudSAubWVudS1ibG9jay13cmFwcGVyLm1lbnUtbmFtZS1tYWluLW1lbnUubWVudS1sZXZlbC0xJykudmVsb2NpdHkoe1xuICAgICAgICAgIG9wYWNpdHk6IDAuMlxuICAgICAgICB9LCB7XG4gICAgICAgICAgZHVyYXRpb246IDIwMCxcbiAgICAgICAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICAgICAgICBxdWV1ZTogXCJcIixcbiAgICAgICAgICBiZWdpbjogdW5kZWZpbmVkLFxuICAgICAgICAgIHByb2dyZXNzOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29tcGxldGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBkaXNwbGF5OiB1bmRlZmluZWQsXG4gICAgICAgICAgdmlzaWJpbGl0eTogdW5kZWZpbmVkLFxuICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgIGRlbGF5OiBmYWxzZSxcbiAgICAgICAgICBtb2JpbGVIQTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gaGlkZVNlYXJjaCgpe1xuICAgICAgICAkKCcuZGVza3RvcC1zZWFyY2gtd3JhcHBlciAubWFpbi1uYXYtc2VhcmNoLWZvcm0nKS5kYXRhKCdzaG93bicsIDApO1xuXG4gICAgICAgICQoJy5kZXNrdG9wLXNlYXJjaC13cmFwcGVyIC5tYWluLW5hdi1zZWFyY2gtZm9ybSAuZm9ybS10eXBlLXRleHRmaWVsZCcpLnZlbG9jaXR5KHtcbiAgICAgICAgICB3aWR0aDogXCI4MHB4XCIsXG4gICAgICAgICAgb3BhY2l0eTogMC4wXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBkdXJhdGlvbjogNDAwLFxuICAgICAgICAgIGVhc2luZzogXCJzd2luZ1wiLFxuICAgICAgICAgIHF1ZXVlOiBcIlwiLFxuICAgICAgICAgIGJlZ2luOiB1bmRlZmluZWQsXG4gICAgICAgICAgcHJvZ3Jlc3M6IHVuZGVmaW5lZCxcbiAgICAgICAgICBjb21wbGV0ZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGRpc3BsYXk6IHVuZGVmaW5lZCxcbiAgICAgICAgICB2aXNpYmlsaXR5OiB1bmRlZmluZWQsXG4gICAgICAgICAgbG9vcDogZmFsc2UsXG4gICAgICAgICAgZGVsYXk6IGZhbHNlLFxuICAgICAgICAgIG1vYmlsZUhBOiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJy5yZWdpb24tbWFpbi1tZW51IC5tZW51LWJsb2NrLXdyYXBwZXIubWVudS1uYW1lLW1haW4tbWVudS5tZW51LWxldmVsLTEnKS52ZWxvY2l0eSh7XG4gICAgICAgICAgb3BhY2l0eTogMS4wXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBkdXJhdGlvbjogMjAwLFxuICAgICAgICAgIGVhc2luZzogXCJzd2luZ1wiLFxuICAgICAgICAgIHF1ZXVlOiBcIlwiLFxuICAgICAgICAgIGJlZ2luOiB1bmRlZmluZWQsXG4gICAgICAgICAgcHJvZ3Jlc3M6IHVuZGVmaW5lZCxcbiAgICAgICAgICBjb21wbGV0ZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGRpc3BsYXk6IHVuZGVmaW5lZCxcbiAgICAgICAgICB2aXNpYmlsaXR5OiB1bmRlZmluZWQsXG4gICAgICAgICAgbG9vcDogZmFsc2UsXG4gICAgICAgICAgZGVsYXk6IDIwMCxcbiAgICAgICAgICBtb2JpbGVIQTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgRHJ1cGFsLmJlaGF2aW9ycy5leGNlbHBvaW50X3NlYXJjaF9tb2JpbGUgPSB7XG4gICAgYXR0YWNoOiBmdW5jdGlvbiAoY29udGV4dCwgc2V0dGluZ3MpIHtcblxuICAgICAgLy8gSGlkZSBzZWFyY2ggd2hlbiBlbHNlIHdoZXJlIGlzIGNsaWNrZWQuXG4gICAgICAkKCcjbWFpbi13cmFwcGVyLCAjZm9vdGVyLCAjZm9vdGVyMicpLmNsaWNrKGZ1bmN0aW9uIChlKXtcblxuICAgICAgICBpZiAoJCgnLm1vYmlsZS1zZWFyY2gtdHJpZ2dlcicpLmlzKGUuY3VycmVudFRhcmdldCkpe1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjb250YWluZXIgPSAkKFwiLm1vYmlsZS1zZWFyY2gtd3JhcHBlciAubWFpbi1uYXYtc2VhcmNoLWZvcm1cIik7XG4gICAgICAgIGlmIChjb250YWluZXIuZGF0YSgnc2hvd24nKSA9PSAxKSB7XG4gICAgICAgICAgaWYgKCFjb250YWluZXIuaXMoZS50YXJnZXQpIC8vIGlmIHRoZSB0YXJnZXQgb2YgdGhlIGNsaWNrIGlzbid0IHRoZSBjb250YWluZXIuLi5cbiAgICAgICAgICAgICYmIGNvbnRhaW5lci5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMCkgLy8gLi4uIG5vciBhIGRlc2NlbmRhbnQgb2YgdGhlIGNvbnRhaW5lclxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGhpZGVNb2JpbGVTZWFyY2goKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vYmlsZVxuICAgICAgJCgnLm1vYmlsZS1zZWFyY2gtdHJpZ2dlcicpLmNsaWNrKGZ1bmN0aW9uKGUpe1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBzaG93TW9iaWxlU2VhcmNoKCk7XG4gICAgICB9KTtcbiAgICAgICQoJy5tb2JpbGUtc2VhcmNoLXdyYXBwZXIgLm1haW4tbmF2LXNlYXJjaC1mb3JtIC5mb3JtLXN1Ym1pdCcpLmNsaWNrKGZ1bmN0aW9uKGUpe1xuICAgICAgICB2YXIgc2VhcmNoVGVybSA9ICQoJy5tb2JpbGUtc2VhcmNoLXdyYXBwZXIgLm1haW4tbmF2LXNlYXJjaC1mb3JtIGlucHV0LmZvcm0tdGV4dCcpLnZhbCgpO1xuICAgICAgICBpZiAoIXNlYXJjaFRlcm0pIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgaGlkZU1vYmlsZVNlYXJjaCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gc2hvd01vYmlsZVNlYXJjaCgpe1xuICAgICAgICAkKCcubW9iaWxlLXNlYXJjaC13cmFwcGVyIC5tYWluLW5hdi1zZWFyY2gtZm9ybScpLmRhdGEoJ3Nob3duJywgMSk7XG5cbiAgICAgICAgJCgnLm1vYmlsZS1zZWFyY2gtd3JhcHBlcicpLmNzcygnb3BhY2l0eScsIDApLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5zaG93KCkudmVsb2NpdHkoe1xuICAgICAgICAgIG9wYWNpdHk6IDEuMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgZHVyYXRpb246IDIwMCxcbiAgICAgICAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICAgICAgICBxdWV1ZTogXCJcIixcbiAgICAgICAgICBiZWdpbjogdW5kZWZpbmVkLFxuICAgICAgICAgIHByb2dyZXNzOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29tcGxldGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBkaXNwbGF5OiB1bmRlZmluZWQsXG4gICAgICAgICAgdmlzaWJpbGl0eTogdW5kZWZpbmVkLFxuICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgIGRlbGF5OiBmYWxzZSxcbiAgICAgICAgICBtb2JpbGVIQTogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICAkKCcubWFpbi1uYXYtc2VhcmNoLWZvcm0gLmZvcm0tdHlwZS10ZXh0ZmllbGQnKS52ZWxvY2l0eSh7XG4gICAgICAgICAgd2lkdGg6ICcxMDAlJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgZHVyYXRpb246IDQwMCxcbiAgICAgICAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICAgICAgICBxdWV1ZTogXCJcIixcbiAgICAgICAgICBiZWdpbjogdW5kZWZpbmVkLFxuICAgICAgICAgIHByb2dyZXNzOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29tcGxldGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBkaXNwbGF5OiB1bmRlZmluZWQsXG4gICAgICAgICAgdmlzaWJpbGl0eTogdW5kZWZpbmVkLFxuICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgIGRlbGF5OiBmYWxzZSxcbiAgICAgICAgICBtb2JpbGVIQTogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICAkKCcubmF2YmFyLWJyYW5kLCAubW9iaWxlLWNvdW50cnktc3dpdGNoZXIsICNzbG9nYW4nKS52ZWxvY2l0eSh7XG4gICAgICAgICAgb3BhY2l0eTogMC4yXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBkdXJhdGlvbjogMjAwLFxuICAgICAgICAgIGVhc2luZzogXCJzd2luZ1wiLFxuICAgICAgICAgIHF1ZXVlOiBcIlwiLFxuICAgICAgICAgIGJlZ2luOiB1bmRlZmluZWQsXG4gICAgICAgICAgcHJvZ3Jlc3M6IHVuZGVmaW5lZCxcbiAgICAgICAgICBjb21wbGV0ZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGRpc3BsYXk6IHVuZGVmaW5lZCxcbiAgICAgICAgICB2aXNpYmlsaXR5OiB1bmRlZmluZWQsXG4gICAgICAgICAgbG9vcDogZmFsc2UsXG4gICAgICAgICAgZGVsYXk6IGZhbHNlLFxuICAgICAgICAgIG1vYmlsZUhBOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBoaWRlTW9iaWxlU2VhcmNoKCl7XG4gICAgICAgICQoJy5tb2JpbGUtc2VhcmNoLXdyYXBwZXIgLm1haW4tbmF2LXNlYXJjaC1mb3JtJykuZGF0YSgnc2hvd24nLCAwKTtcblxuICAgICAgICAkKCcubW9iaWxlLXNlYXJjaC13cmFwcGVyJykudmVsb2NpdHkoe1xuICAgICAgICAgIG9wYWNpdHk6IDAuMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgZHVyYXRpb246IDIwMCxcbiAgICAgICAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICAgICAgICBxdWV1ZTogXCJcIixcbiAgICAgICAgICBiZWdpbjogdW5kZWZpbmVkLFxuICAgICAgICAgIHByb2dyZXNzOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAkKCcubW9iaWxlLXNlYXJjaC13cmFwcGVyJykuaGlkZSgpO1xuICAgICAgICAgICAgJCgnLm1haW4tbmF2LXNlYXJjaC1mb3JtIC5mb3JtLXR5cGUtdGV4dGZpZWxkJykuY3NzKCd3aWR0aCcsICcwJScpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZGlzcGxheTogdW5kZWZpbmVkLFxuICAgICAgICAgIHZpc2liaWxpdHk6IHVuZGVmaW5lZCxcbiAgICAgICAgICBsb29wOiBmYWxzZSxcbiAgICAgICAgICBkZWxheTogZmFsc2UsXG4gICAgICAgICAgbW9iaWxlSEE6IHRydWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnLm5hdmJhci1icmFuZCwgLm1vYmlsZS1jb3VudHJ5LXN3aXRjaGVyLCAjc2xvZ2FuJykudmVsb2NpdHkoe1xuICAgICAgICAgIG9wYWNpdHk6IDEuMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgZHVyYXRpb246IDQwMCxcbiAgICAgICAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICAgICAgICBxdWV1ZTogXCJcIixcbiAgICAgICAgICBiZWdpbjogdW5kZWZpbmVkLFxuICAgICAgICAgIHByb2dyZXNzOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29tcGxldGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBkaXNwbGF5OiB1bmRlZmluZWQsXG4gICAgICAgICAgdmlzaWJpbGl0eTogdW5kZWZpbmVkLFxuICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgIGRlbGF5OiAwLFxuICAgICAgICAgIG1vYmlsZUhBOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBEcnVwYWwuYmVoYXZpb3JzLmV4Y2VscG9pbnRfY291bnRyeSA9IHtcbiAgICBhdHRhY2g6IGZ1bmN0aW9uIChjb250ZXh0LCBzZXR0aW5ncykge1xuXG4gICAgICB2YXIgY29udGVudCA9ICc8dWwgY2xhc3M9XCJkcm9wZG93bi1tZW51XCIgZGF0YS1jb250YWluZXI9XCJib2R5XCI+IFxcXG4gICAgICAgIDxsaSBjbGFzcz1cImFjdGl2ZVwiPjxhIGhyZWY9XCIjXCI+U2luZ2Fwb3JlPC9hPjwvbGk+IFxcXG4gICAgICAgIDxsaT48YSBocmVmPVwiI1wiPlBSQy9ISzwvYT48L2xpPiBcXFxuICAgICAgPC91bD4nO1xuICAgICAgY29udGVudCA9ICd0ZXN0JztcblxuICAgICAgJCgnI2NvdW50cnktc3dpdGNoZXInKS5wb3BvdmVyKHtcbiAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgaHRtbDogdHJ1ZSxcbiAgICAgICAgcGxhY2VtZW50OiAnYm90dG9tJ1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIERydXBhbC5iZWhhdmlvcnMucmFzX3RvX3RvcCA9IHtcbiAgICBhdHRhY2g6IGZ1bmN0aW9uIChjb250ZXh0LCBzZXR0aW5ncykge1xuXG4gICAgICAkKCcuYmFjay10by10b3AnKS5jc3MoJ29wYWNpdHknLCAwLjMpO1xuXG4gICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDQwMCkge1xuICAgICAgICAgICQoJy5iYWNrLXRvLXRvcCcpLmNzcygnb3BhY2l0eScsIDEpO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgJCgnLmJhY2stdG8tdG9wJykuY3NzKCdvcGFjaXR5JywgMC4zKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIERydXBhbC5iZWhhdmlvcnMucmFzX2xldHRlcl9icm93c2luZyA9IHtcbiAgICBhdHRhY2g6IGZ1bmN0aW9uIChjb250ZXh0LCBzZXR0aW5ncykge1xuXG4gICAgICAvLyBTYW1wbGUgSFRNTCBzdHJ1Y3R1cmU6XG4gICAgICAvLzxkaXYgY2xhc3M9XCJsZXR0ZXItYnJvd3NpbmctY29udGFpbmVyXCI+XG4gICAgICAvLyAgPHVsPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjYVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+YTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjYlwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+YjwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjY1wiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+YzwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjZFwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+ZDwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjZVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+ZTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjZlwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+ZjwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjZ1wiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+ZzwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjaFwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+aDwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjaVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+aTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjalwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+ajwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIja1wiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+azwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjbFwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+bDwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjbVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+bTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjblwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+bjwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjb1wiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+bzwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjcFwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+cDwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjcVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+cTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjclwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+cjwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjc1wiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+czwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjdFwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+dDwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjdVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+dTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjdlwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+djwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjd1wiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+dzwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjeFwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+eDwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjeVwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+eTwvYT48L2xpPlxuICAgICAgLy8gICAgPGxpPjxhIGhyZWY9XCIjelwiIGNsYXNzPVwibGV0dGVyLWJyb3dzaW5nXCI+ejwvYT48L2xpPlxuICAgICAgLy8gIDwvdWw+XG4gICAgICAvLzwvZGl2PlxuXG5cbiAgICAgIHZhciBjb250YWluZXJzID0gJCgnLmxldHRlci1icm93c2luZy1jb250YWluZXInKTtcbiAgICAgIGlmIChjb250YWluZXJzLmxlbmd0aCA+IDApIHtcblxuICAgICAgICB2YXIgbGV0dGVycyA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicuc3BsaXQoJycpO1xuICAgICAgICB2YXIgYXZhaWxhYmxlX2xldHRlcnMgPSB7fTtcbiAgICAgICAgJCgnYS5sZXR0ZXItYnJvd3NpbmctYW5jaG9yJykuZWFjaChmdW5jdGlvbihpbmRleCwgYW5jaG9yKXtcbiAgICAgICAgICB2YXIgbGV0dGVyID0gJChhbmNob3IpLmRhdGEoJ2xldHRlcicpO1xuICAgICAgICAgIGlmIChsZXR0ZXIpIHtcbiAgICAgICAgICAgIGF2YWlsYWJsZV9sZXR0ZXJzW2xldHRlcl0gPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBsaW5rcyA9IFtdO1xuICAgICAgICBmb3IodmFyIGk9MDsgaTwyNjsgaSsrKSB7XG4gICAgICAgICAgdmFyIGxldHRlciA9IGxldHRlcnNbaV07XG4gICAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICcnO1xuICAgICAgICAgIGlmICh0eXBlb2YgYXZhaWxhYmxlX2xldHRlcnNbbGV0dGVyXSA9PT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgY2xhc3NOYW1lID0gJ3VuYXZhaWxhYmxlJztcbiAgICAgICAgICB9XG4gICAgICAgICAgbGlua3MucHVzaCgnPGxpIGNsYXNzPVwiJyArIGNsYXNzTmFtZSArICdcIj48YSBocmVmPVwiIycgKyBsZXR0ZXIgKyAnXCIgY2xhc3M9XCJsZXR0ZXItYnJvd3NpbmdcIj4nICsgbGV0dGVyICsgJzwvYT48L2xpPicpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlua3MgPSAnPHVsPicgKyBsaW5rcy5qb2luKCcnKSArICc8L3VsPic7XG5cbiAgICAgICAgJChjb250YWluZXJzKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBjb250YWluZXIpe1xuICAgICAgICAgICQoY29udGFpbmVyKS5lbXB0eSgpLmFwcGVuZChsaW5rcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJsZXR0ZXItYnJvd3NpbmctY29udGFpbmVyLWZsb2F0aW5nIGhpZGRlblwiPicgKyBsaW5rcyArICc8L2Rpdj4nKTtcblxuICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKGV2ZW50KXtcblxuICAgICAgICAgIHZhciBzY3JvbGxZID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuXG4gICAgICAgICAgJChjb250YWluZXJzKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBjb250YWluZXIpe1xuICAgICAgICAgICAgaWYgKHNjcm9sbFkgPiAkKGNvbnRhaW5lcikub2Zmc2V0KCkudG9wICsgMzApIHtcbiAgICAgICAgICAgICAgJCgnLmxldHRlci1icm93c2luZy1jb250YWluZXItZmxvYXRpbmcnKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuc2hvdygpO1xuICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAkKCcubGV0dGVyLWJyb3dzaW5nLWNvbnRhaW5lci1mbG9hdGluZycpLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgfVxuICB9O1xuXG5cbn0pKGpRdWVyeSk7XG4iLCIvKipcbiAqIEBmaWxlXG4gKiBKUyBmb3IgUmFkaXguXG4gKi9cbihmdW5jdGlvbiAoJCwgRHJ1cGFsLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHtcbiAgLy8gQWxsb3cgZHJvcGRvd24gbGlua3MgdG8gYmUgY2xpY2thYmxlIGJ5IHNob3dpbmcgZHJvcGRvd25zIG9uIGhvdmVyL2ZvY3VzLlxuICBEcnVwYWwuYmVoYXZpb3JzLnJhZGl4X2Ryb3Bkb3duID0ge1xuICAgIGF0dGFjaDogZnVuY3Rpb24oY29udGV4dCwgc2V0dGluZykge1xuXG4gICAgICAvLyBXZSBkb24ndCB3YW50IHRoZSBhdXRvIHNob3dpbmcgb2YgZHJvcGRvd25zLlxuICAgICAgJCgnLmRyb3Bkb3duLXNwZWNpYWwnKS5vbmNlKCdyYWRpeC1kcm9wZG93bicsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBkcm9wZG93biA9IHRoaXM7XG5cbiAgICAgICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHNob3cgdGhlIGRyb3Bkb3duLlxuICAgICAgICBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgICAgIGlmICghJChkcm9wZG93bikuaGFzQ2xhc3MoJ29wZW4nKSkge1xuICAgICAgICAgICAgJCgnPltkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJdJywgZHJvcGRvd24pLnRyaWdnZXIoJ2NsaWNrLmJzLmRyb3Bkb3duJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGhpZGUgdGhlIGRyb3Bkb3duLlxuICAgICAgICBmdW5jdGlvbiBoaWRlKCkge1xuICAgICAgICAgIGlmICgkKGRyb3Bkb3duKS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICAgICAgICAkKCc+W2RhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIl0nLCBkcm9wZG93bikudHJpZ2dlcignY2xpY2suYnMuZHJvcGRvd24nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IGRyb3Bkb3duIG9uIGhvdmVyIGFuZCBmb2N1cy5cbiAgICAgICAgJCh0aGlzKS5vbignbW91c2VlbnRlci5yYWRpeC5kcm9wZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBzaG93KCk7XG4gICAgICAgIH0pO1xuICAgICAgICAkKHRoaXMpLm9uKCdtb3VzZWxlYXZlLnJhZGl4LmRyb3Bkb3duJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgJCh0aGlzKS5vbignZm9jdXNpbi5yYWRpeC5kcm9wZG93bicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNob3coKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJ2JvZHknKS5vbmNlKCdyYWRpeC1kcm9wZG93bicpLm9uKCdmb2N1c291dC5yYWRpeC5kcm9wZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2YXIgcGFyZW50ID0gJChlLnRhcmdldCkuY2xvc2VzdCgnbGkucmFkaXgtZHJvcGRvd24tcHJvY2Vzc2VkLm9wZW4nKS5nZXQoMCk7XG4gICAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgLy8gRGVmZXIgdG8gYWZ0ZXIgYWxsIGhhbmRsZXJzIHNvIHdlIGNhbiBzZWUgd2hlcmUgZm9jdXMgbGFuZGVkLlxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIC8vIERvbid0IGRvIGFueXRoaW5nIGlmIG5vIGVsZW1lbnQgaXMgZm9jdXNlZCAtIHRoYXQgY2FuIG9ubHlcbiAgICAgICAgICAgICAgLy8gaGFwcGVuIHdpdGggdGhlIG1vdXNlIGFuZCB0aGlzIGlzIG1lYW50IHRvIGNsb3NlIHRoZSBtZW51XG4gICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGtleWJvYXJkIGlzIHVzZWQgdG8gY2hhbmdlIGZvY3VzLlxuICAgICAgICAgICAgICBpZiAoIWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBIaWRlIHRoZSBwYXJlbnQgaWYgaXQgZG9lc24ndCBjb250YWluIHRoZSBub3cgZm9jdXNlZCBlbGVtZW50XG4gICAgICAgICAgICAgIC8vIGFuZCBpcyBzdGlsbCBvcGVuLlxuICAgICAgICAgICAgICBpZiAoIXBhcmVudC5jb250YWlucyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KSAmJiAkKHBhcmVudCkuaGFzQ2xhc3MoJ29wZW4nKSkge1xuICAgICAgICAgICAgICAgICQocGFyZW50KS50cmlnZ2VyKCdjbGljay5icy5kcm9wZG93bicpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQodGhpcykub24oJ2tleWRvd24ucmFkaXguZHJvcGRvd24nLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgLy8gUHJldmVudCB1cC9kb3duIGFycm93IGZyb20gZG9pbmcgYW55dGhpbmcgLS0gdGhleSBjb25mbGljdCB3aXRoXG4gICAgICAgICAgLy8gdXNpbmcgZm9jdXMgdG8gc2hvdyB0aGUgZHJvcGRvd24sIGFuZCB0aGUgZGVmYXVsdCBCb290c3RyYXAga2V5ZG93blxuICAgICAgICAgIC8vIGhhbmRsZXIgd2lsbCB0cmlnZ2VyIG91ciBjbGljayBoYW5kbGVyIHRvIHZpc2l0IHRoZSBsaW5rLlxuICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMzggfHwgZS5rZXlDb2RlID09IDQwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIFNob3cvaGlkZSBkcm9wZG93biB3aXRoIHNwYWNlYmFyLlxuICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMzIpIHtcbiAgICAgICAgICAgICQoJz5bZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXScsIGRyb3Bkb3duKS50cmlnZ2VyKCdjbGljay5icy5kcm9wZG93bicpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBIaWRlIHRoZSBkcm9wZG93biB3aXRoIHRoZSBlc2NhcGUgaGV5LlxuICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMjcpIHtcbiAgICAgICAgICAgIC8vIExlYXZlIGZvY3VzIG9uIHRoZSBwYXJlbnQgYWZ0ZXIgaXQncyBoaWRkZW4uXG4gICAgICAgICAgICAkKCc+W2RhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIl0nLCBkcm9wZG93bikuZm9jdXMoKTtcbiAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFsbG93IGEuZHJvcGRvd24tdG9nZ2xlIHRvIGJlIGNsaWNrYWJsZS5cbiAgICAgICAgaWYgKCQodGhpcykuaGFzKCc+IGEuZHJvcGRvd24tdG9nZ2xlJykpIHtcbiAgICAgICAgICAkKHRoaXMpLm9uKCdjbGljay5yYWRpeC5kcm9wZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJChlLnRhcmdldCk7XG4gICAgICAgICAgICBpZiAoJHRhcmdldC5wYXJlbnQoKS5nZXQoMCkgPT0gZHJvcGRvd24gJiYgJHRhcmdldC5pcygnYS5kcm9wZG93bi10b2dnbGUnKSAmJiAkdGFyZ2V0LmF0dHIoJ2hyZWYnKSkge1xuICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJHRhcmdldC5hdHRyKCdocmVmJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIEJvb3RzdHJhcCB0b29sdGlwLlxuICBEcnVwYWwuYmVoYXZpb3JzLnJhZGl4X3Rvb2x0aXAgPSB7XG4gICAgYXR0YWNoOiBmdW5jdGlvbihjb250ZXh0LCBzZXR0aW5nKSB7XG4gICAgICBpZiAoJC5mbi50b29sdGlwKSB7XG4gICAgICAgICQoXCJbZGF0YS10b2dnbGU9J3Rvb2x0aXAnXVwiKS50b29sdGlwKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQm9vdHN0cmFwIHBvcG92ZXIuXG4gIERydXBhbC5iZWhhdmlvcnMucmFkaXhfcG9wb3ZlciA9IHtcbiAgICBhdHRhY2g6IGZ1bmN0aW9uKGNvbnRleHQsIHNldHRpbmcpIHtcbiAgICAgIGlmICgkLmZuLnBvcG92ZXIpIHtcbiAgICAgICAgJChcIltkYXRhLXRvZ2dsZT0ncG9wb3ZlciddXCIpLnBvcG92ZXIoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAvLyBTaG93IGZpcnN0IHRhYiBieSBkZWZhdWx0LlxuICAgIC8vIElnbm9yZSB0aGUgXCJwcmltYXJ5XCIgdGFicyBvbiB0aGUgbm9kZSBlZGl0IHBhZ2UuXG4gICAgaWYgKCQuZm4udGFiKSB7XG4gICAgICB2YXIgdGFicyA9ICQoJy5uYXYtdGFicycpLm5vdCgnLnByaW1hcnknKTtcbiAgICAgIHRhYnMuY2hpbGRyZW4oJ2xpJykuZmlyc3QoKS5maW5kKCdhJykudGFiKCdzaG93Jyk7XG5cbiAgICAgIGlmIChoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2gpIHtcbiAgICAgICAgJCgnLm5hdi10YWJzID4gbGkgPiBhW2hyZWYkPVwiJyArIGhhc2ggKyAnXCJdJykudGFiKCdzaG93Jyk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn0pKGpRdWVyeSwgRHJ1cGFsLCB0aGlzLCB0aGlzLmRvY3VtZW50KTtcbiIsIi8qKlxuICogQGZpbGVcbiAqIEpTIGZvciBSYWRpeC5cbiAqL1xuKGZ1bmN0aW9uICgkLCBEcnVwYWwsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xuICAvLyBBbGxvdyBkcm9wZG93biBsaW5rcyB0byBiZSBjbGlja2FibGUgYnkgc2hvd2luZyBkcm9wZG93bnMgb24gaG92ZXIvZm9jdXMuXG4gIERydXBhbC5iZWhhdmlvcnMucmFkaXhfZHJvcGRvd24gPSB7XG4gICAgYXR0YWNoOiBmdW5jdGlvbihjb250ZXh0LCBzZXR0aW5nKSB7XG4gICAgICAkKCcuZHJvcGRvd24tc3BlY2lhbCcpLm9uY2UoJ3JhZGl4LWRyb3Bkb3duJywgZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGRyb3Bkb3duID0gdGhpcztcblxuICAgICAgICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gc2hvdyB0aGUgZHJvcGRvd24uXG4gICAgICAgIGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAgICAgaWYgKCEkKGRyb3Bkb3duKS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICAgICAgICAkKCc+W2RhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIl0nLCBkcm9wZG93bikudHJpZ2dlcignY2xpY2suYnMuZHJvcGRvd24nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gaGlkZSB0aGUgZHJvcGRvd24uXG4gICAgICAgIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgICAgICAgaWYgKCQoZHJvcGRvd24pLmhhc0NsYXNzKCdvcGVuJykpIHtcbiAgICAgICAgICAgICQoJz5bZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXScsIGRyb3Bkb3duKS50cmlnZ2VyKCdjbGljay5icy5kcm9wZG93bicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgZHJvcGRvd24gb24gaG92ZXIgYW5kIGZvY3VzLlxuICAgICAgICAkKHRoaXMpLm9uKCdtb3VzZWVudGVyLnJhZGl4LmRyb3Bkb3duJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHNob3coKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQodGhpcykub24oJ21vdXNlbGVhdmUucmFkaXguZHJvcGRvd24nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBoaWRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICAkKHRoaXMpLm9uKCdmb2N1c2luLnJhZGl4LmRyb3Bkb3duJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2hvdygpO1xuICAgICAgICB9KTtcbiAgICAgICAgJCgnYm9keScpLm9uY2UoJ3JhZGl4LWRyb3Bkb3duJykub24oJ2ZvY3Vzb3V0LnJhZGl4LmRyb3Bkb3duJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHZhciBwYXJlbnQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCdsaS5yYWRpeC1kcm9wZG93bi1wcm9jZXNzZWQub3BlbicpLmdldCgwKTtcbiAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAvLyBEZWZlciB0byBhZnRlciBhbGwgaGFuZGxlcnMgc28gd2UgY2FuIHNlZSB3aGVyZSBmb2N1cyBsYW5kZWQuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgLy8gRG9uJ3QgZG8gYW55dGhpbmcgaWYgbm8gZWxlbWVudCBpcyBmb2N1c2VkIC0gdGhhdCBjYW4gb25seVxuICAgICAgICAgICAgICAvLyBoYXBwZW4gd2l0aCB0aGUgbW91c2UgYW5kIHRoaXMgaXMgbWVhbnQgdG8gY2xvc2UgdGhlIG1lbnVcbiAgICAgICAgICAgICAgLy8gd2hlbiB0aGUga2V5Ym9hcmQgaXMgdXNlZCB0byBjaGFuZ2UgZm9jdXMuXG4gICAgICAgICAgICAgIGlmICghZG9jdW1lbnQuYWN0aXZlRWxlbWVudCB8fCBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8vIEhpZGUgdGhlIHBhcmVudCBpZiBpdCBkb2Vzbid0IGNvbnRhaW4gdGhlIG5vdyBmb2N1c2VkIGVsZW1lbnRcbiAgICAgICAgICAgICAgLy8gYW5kIGlzIHN0aWxsIG9wZW4uXG4gICAgICAgICAgICAgIGlmICghcGFyZW50LmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpICYmICQocGFyZW50KS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICAgICAgICAgICAgJChwYXJlbnQpLnRyaWdnZXIoJ2NsaWNrLmJzLmRyb3Bkb3duJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCh0aGlzKS5vbigna2V5ZG93bi5yYWRpeC5kcm9wZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAvLyBQcmV2ZW50IHVwL2Rvd24gYXJyb3cgZnJvbSBkb2luZyBhbnl0aGluZyAtLSB0aGV5IGNvbmZsaWN0IHdpdGhcbiAgICAgICAgICAvLyB1c2luZyBmb2N1cyB0byBzaG93IHRoZSBkcm9wZG93biwgYW5kIHRoZSBkZWZhdWx0IEJvb3RzdHJhcCBrZXlkb3duXG4gICAgICAgICAgLy8gaGFuZGxlciB3aWxsIHRyaWdnZXIgb3VyIGNsaWNrIGhhbmRsZXIgdG8gdmlzaXQgdGhlIGxpbmsuXG4gICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAzOCB8fCBlLmtleUNvZGUgPT0gNDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gU2hvdy9oaWRlIGRyb3Bkb3duIHdpdGggc3BhY2ViYXIuXG4gICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAzMikge1xuICAgICAgICAgICAgJCgnPltkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJdJywgZHJvcGRvd24pLnRyaWdnZXIoJ2NsaWNrLmJzLmRyb3Bkb3duJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIEhpZGUgdGhlIGRyb3Bkb3duIHdpdGggdGhlIGVzY2FwZSBoZXkuXG4gICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykge1xuICAgICAgICAgICAgLy8gTGVhdmUgZm9jdXMgb24gdGhlIHBhcmVudCBhZnRlciBpdCdzIGhpZGRlbi5cbiAgICAgICAgICAgICQoJz5bZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXScsIGRyb3Bkb3duKS5mb2N1cygpO1xuICAgICAgICAgICAgaGlkZSgpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWxsb3cgYS5kcm9wZG93bi10b2dnbGUgdG8gYmUgY2xpY2thYmxlLlxuICAgICAgICBpZiAoJCh0aGlzKS5oYXMoJz4gYS5kcm9wZG93bi10b2dnbGUnKSkge1xuICAgICAgICAgICQodGhpcykub24oJ2NsaWNrLnJhZGl4LmRyb3Bkb3duJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyICR0YXJnZXQgPSAkKGUudGFyZ2V0KTtcbiAgICAgICAgICAgIGlmICgkdGFyZ2V0LnBhcmVudCgpLmdldCgwKSA9PSBkcm9wZG93biAmJiAkdGFyZ2V0LmlzKCdhLmRyb3Bkb3duLXRvZ2dsZScpICYmICR0YXJnZXQuYXR0cignaHJlZicpKSB7XG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAkdGFyZ2V0LmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQm9vdHN0cmFwIHRvb2x0aXAuXG4gIERydXBhbC5iZWhhdmlvcnMucmFkaXhfdG9vbHRpcCA9IHtcbiAgICBhdHRhY2g6IGZ1bmN0aW9uKGNvbnRleHQsIHNldHRpbmcpIHtcbiAgICAgIGlmICgkLmZuLnRvb2x0aXApIHtcbiAgICAgICAgJChcIltkYXRhLXRvZ2dsZT0ndG9vbHRpcCddXCIpLnRvb2x0aXAoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBCb290c3RyYXAgcG9wb3Zlci5cbiAgRHJ1cGFsLmJlaGF2aW9ycy5yYWRpeF9wb3BvdmVyID0ge1xuICAgIGF0dGFjaDogZnVuY3Rpb24oY29udGV4dCwgc2V0dGluZykge1xuICAgICAgaWYgKCQuZm4ucG9wb3Zlcikge1xuICAgICAgICAkKFwiW2RhdGEtdG9nZ2xlPSdwb3BvdmVyJ11cIikucG9wb3ZlcigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIC8vIFNob3cgZmlyc3QgdGFiIGJ5IGRlZmF1bHQuXG4gICAgLy8gSWdub3JlIHRoZSBcInByaW1hcnlcIiB0YWJzIG9uIHRoZSBub2RlIGVkaXQgcGFnZS5cbiAgICBpZiAoJC5mbi50YWIpIHtcbiAgICAgIHZhciB0YWJzID0gJCgnLm5hdi10YWJzJykubm90KCcucHJpbWFyeScpO1xuICAgICAgdGFicy5jaGlsZHJlbignbGknKS5maXJzdCgpLmZpbmQoJ2EnKS50YWIoJ3Nob3cnKTtcblxuICAgICAgaWYgKGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaCkge1xuICAgICAgICAkKCcubmF2LXRhYnMgPiBsaSA+IGFbaHJlZiQ9XCInICsgaGFzaCArICdcIl0nKS50YWIoJ3Nob3cnKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufSkoalF1ZXJ5LCBEcnVwYWwsIHRoaXMsIHRoaXMuZG9jdW1lbnQpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
